<html>
  
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="../../style.css">
    <base target="_parent">
    <title data-trilium-title>Vulnerability Assessment</title>
  </head>
  
  <body>
    <div class="content">
       <h1 data-trilium-h1>Vulnerability Assessment</h1>

      <div class="ck-content">
        <ul>
          <li data-list-item-id="e35f9d40c651b95f4dccdc0a8777f7283">Buffer overflows are caused coding errors which allows attackers writing
            data to a buffer to over run the buffer consequently writing data to allocated
            memory addresses.</li>
          <li data-list-item-id="e8b35fb3aebc1aebe0b1c79a3b3791a20">PrivEsca</li>
          <li data-list-item-id="efceb04ebeeda85a9a74b33166edbe07f">RCE (remote code execution)</li>
        </ul>
        <hr>
        <h3>Frequently Exploited Windows Services</h3>
        <ul>
          <li data-list-item-id="e8b60ece809479692c4f285b4fd187495">
            <figure class="image">
              <img style="aspect-ratio:1397/786;" src="Vulnerability Assessment_i.png"
              width="1397" height="786">
            </figure>
          </li>
        </ul>
        <hr>
        <h3>Vulnerability Scanning with MSF (Nessus)</h3>
        <ul>
          <li data-list-item-id="e8b62de2ddee8d5131163dc0fea96ec59">we can change payload of the exploit via <strong>set payload windows/meterpreter/reverse_tcp </strong>which
            essentially used to tell the msf that we are exploiting a windows machine</li>
          <li
          data-list-item-id="e7cdb7193a530f46bc76baa8cf254c796">searchsploit allows us to search exploits in exploits_db, we can use this
            to get the exploits that are not in msf</li>
            <li data-list-item-id="e8f002e0d72e2c54e86536a69b54fe5cf"><strong>metasploit-autopwn</strong> plugin repo is easy exploit &amp; vulnerablity
              attack.</li>
            <li data-list-item-id="efbc34bd404b6ad2a104bbda40a060b41">
              <p>type db_autopwn in msfconsole to get the options</p>
              <figure class="image image_resized"
              style="width:42.77%;">
                <img style="aspect-ratio:462/305;" src="2_Vulnerability Assessment_i.png"
                width="462" height="305">
              </figure>
            </li>
            <li data-list-item-id="e7e03810e214ae9f02e990d3c549df1a9">
              <p>One way to use db_autopwn</p>
              <figure class="image">
                <img style="aspect-ratio:533/303;" src="17_Vulnerability Assessment_i.png"
                width="533" height="303">
              </figure>
            </li>
            <li data-list-item-id="ea772f80a8363281eb9a95b9663ffcefd">
              <p><strong>analyze </strong>command analyses the contents of msf database
                to provide you list of vulnerabilites those services suffer from</p>
              <figure
              class="image">
                <img style="aspect-ratio:891/300;" src="9_Vulnerability Assessment_i.png"
                width="891" height="300">
                </figure>
                <hr>
                <h3>WebDAV Vulnerabilities</h3>
            </li>
            <li data-list-item-id="e7fbe9bf6e08cba1865c9854880626de3">
              <figure class="image image_resized" style="width:67.25%;">
                <img style="aspect-ratio:651/369;" src="15_Vulnerability Assessment_i.png"
                width="651" height="369">
              </figure>
            </li>
            <li data-list-item-id="e1cb80c95fff556476ab5f25dca109702">
              <p>Tools:</p>
              <figure class="image image_resized" style="width:67.85%;">
                <img style="aspect-ratio:655/359;" src="3_Vulnerability Assessment_i.png"
                width="655" height="359">
              </figure>
            </li>
            <li data-list-item-id="e1ea6154ebbd89bea3c2e3aa3142e120a">nmap scan</li>
            <li data-list-item-id="ec8940e2f260151b55a8a4c7880ec1032">use hydra to brute force any directories that require authentication</li>
            <li
            data-list-item-id="eb51414d625b66d359206d050dd28bab1">WebDav essentially allows us to upload,download, delete and modify files
              from the server</li>
              <li data-list-item-id="e0febf60bcdb14d11e1bab4064a15e37e">
                <p>davtest is used for this</p>
                <figure class="image">
                  <img style="aspect-ratio:823/136;" src="5_Vulnerability Assessment_i.png"
                  width="823" height="136">
                </figure>
              </li>
              <li data-list-item-id="e2fef8447ae091e29c8afab7459dc6591">this tells us which types of files we are allowed to upload or excute
                on the server</li>
              <li data-list-item-id="e099ed6723e2cac36fca078eadf3a0d60">cadaver is used to upload the file after the above command.</li>
              <li data-list-item-id="eca5b0c5f76a8a7ce7686de484fe7e347">provides the psuedo shell with which we can upload a payload</li>
              <li data-list-item-id="ea2e314897b767082cbb64b6aa31ac10c">kali comes with some shells /usr/share/webshells/</li>
        </ul>
        <hr>
        <h3>Vulnerability Analysis&nbsp;</h3>
        <ul>
          <li data-list-item-id="e3d627a867f114b5e1bdfb92575acd9da">eternal blue</li>
          <li data-list-item-id="e720b16899f30d91686a66b7d121923b9">blue keep (win7 SP1)</li>
        </ul>
        <h3>Blue Keep</h3>
        <ul>
          <li data-list-item-id="e07ad55970f9f78f5842ec9765099c171">msfconsole</li>
          <li data-list-item-id="ec518b963ec91bbd0c8cbf4e5897e741e">auxiliary and exploit module present (64bit only)</li>
          <li data-list-item-id="e9849f4b65131627acb0374d6922bfe79">need to manually configure the target</li>
          <li data-list-item-id="e2f9d3268532003069225de3e0cd5ab6a">
            <p>show targets</p>
            <figure class="image">
              <img style="aspect-ratio:546/260;" src="4_Vulnerability Assessment_i.png"
              width="546" height="260">
            </figure>
          </li>
          <li data-list-item-id="e03b781d54336a55462ad09e252a82399">set the target based on recon</li>
          <li data-list-item-id="e3e430d48f18a6a3e31a7652341d0cc6e">
            <p>modify this depending on the RAM of the target&nbsp;</p>
            <figure class="image">
              <img style="aspect-ratio:893/263;" src="14_Vulnerability Assessment_i.png"
              width="893" height="263">
            </figure>
          </li>
          <li data-list-item-id="efd88e441c380b2222824535a37da826a">use kernal level exploits carefully on a companiy's machine because it
            will most probably crash the system loosing data.</li>
        </ul>
        <hr>
        <h3>Pass the Hash Attack</h3>
        <ul>
          <li data-list-item-id="e636ef131b4b260f232a5c5f4a4717619">After obtaining NTLM hashes</li>
          <li data-list-item-id="ee21bbc10ad471799edee0c4a496ad1f6">utilizing them to auth legit user and target via smb</li>
          <li data-list-item-id="e843e64c42a726c72a40c230da3f101ca">
            <p>many tools to exploit it</p>
            <figure class="image">
              <img style="aspect-ratio:653/367;" src="12_Vulnerability Assessment_i.png"
              width="653" height="367">
            </figure>
          </li>
          <li data-list-item-id="e5b9f15443a5d6f58d8722021ae28b77c">if the service which was used to get access of the target get taken down
            we can do this</li>
          <li data-list-item-id="e5f9a703068dec0edea6ceb004fd5a63c">badblue(module name)</li>
          <li data-list-item-id="e4b40ce150b1a2e158203fedf28658fff">
            <figure class="image">
              <img style="aspect-ratio:748/336;" src="8_Vulnerability Assessment_i.png"
              width="748" height="336">
            </figure>
          </li>
          <li data-list-item-id="e9ed2a7b7a2363a825ef9e953bfdef62c">kiwi is same a mimikatz</li>
          <li data-list-item-id="e9a2926f5c22ae40876ef305d9b11da06">psexec module to do authenticated user code execution meaning you will
            need creds for that</li>
          <li data-list-item-id="ea15706d634aef295651a18cb99d5bea5">we can configure the target with <strong>set target</strong>
          </li>
          <li data-list-item-id="e4df60fc380b7d5cf4f7e50a1fb5a03b8">crackmapexec is another tool for this</li>
        </ul>
        <h3>Some of Frequently exploited services (LINUX)</h3>
        <ul>
          <li data-list-item-id="e259c1446b5a3603ee80c0b5224ee2687">FTP</li>
          <li data-list-item-id="e72f9fb980d95af0ba1c2424109f519e4">SSH</li>
          <li data-list-item-id="e1702102323ed1451eeb8a69aa3dd767a">SAMBA</li>
          <li data-list-item-id="e1b78502be5b020e981047aae4cbbf954">Apache Webserver</li>
        </ul>
        <hr>
        <h3>Shellshock in linux</h3>
        <ul>
          <li data-list-item-id="e007bfc37b22ee2560744f5d809e5c925">
            <figure class="image">
              <img style="aspect-ratio:652/364;" src="6_Vulnerability Assessment_i.png"
              width="652" height="364">
            </figure>
          </li>
          <li data-list-item-id="eadc628c4db7fba0fa063e77d0db36295">
            <figure class="image">
              <img style="aspect-ratio:652/362;" src="13_Vulnerability Assessment_i.png"
              width="652" height="362">
            </figure>
          </li>
          <li data-list-item-id="e340ef087529fbddb95ce025da8c30eb7">Learn CGI scripts how they look like(they arent used anymore tho)</li>
          <li
          data-list-item-id="e8b8127a3a794418d60b9a9f3b87fe53c">
            <figure class="image">
              <img style="aspect-ratio:896/83;" src="1_Vulnerability Assessment_i.png"
              width="896" height="83">
            </figure>
            </li>
            <li data-list-item-id="e1366f33821b9ac62ff1624a31e18c381">foxyproxy extension in firefox as a simple burpsuite</li>
            <li data-list-item-id="ec7618dcf38ffff72018de9dc631c0f9e">cat /etc/*issue to see the info about the distribution</li>
            <li data-list-item-id="e5cfdbe3f0cc531cb9e23c538e6851b12">
              <figure class="image">
                <img style="aspect-ratio:856/147;" src="7_Vulnerability Assessment_i.png"
                width="856" height="147">
              </figure>
            </li>
            <li data-list-item-id="e177c272cb7f9d3fee55dd859a4c76222">
              <p>with msf</p>
              <figure class="image">
                <img style="aspect-ratio:703/101;" src="10_Vulnerability Assessment_i.png"
                width="703" height="101">
              </figure>
            </li>
        </ul>
        <hr>
        <h3>Vulnerability assessment with NESSUS</h3>
        <ul>
          <li data-list-item-id="efb93923b3a2898649ba0b3d3c8b67d11">we can use the nesses scan output in metasploit</li>
          <li data-list-item-id="efcdf98e9eea3a5945fd6a30ab5e599c6">nessus free edition allows 16 ip scans only</li>
          <li data-list-item-id="ec16ec770c08a7cf46686c6284f611cf0">vulns give you all the vulnerabilities from the scan result</li>
          <li data-list-item-id="eeb5f0f4494e19da4e6765edd3f64f9c8">
            <p>vulns -p port allows us to filter the vulnerabilites accordingto port</p>
            <figure
            class="image">
              <img style="aspect-ratio:907/350;" src="16_Vulnerability Assessment_i.png"
              width="907" height="350">
              </figure>
          </li>
          <li data-list-item-id="e5ce484f2e8ea26739b536b75043f2c5e">type <strong>services</strong> to see the services after importing the scan
            results in xml file</li>
          <li data-list-item-id="ec8164f7be424f472e939ab40ab08d4bc"><strong>search cve:year name:smb(example) </strong>all the related modules
            of msf related to that service</li>
        </ul>
        <hr>
        <h3>Web App Vulnerability Scanning with WMAP</h3>
        <ul>
          <li data-list-item-id="e9ab2d5a9bc0a59e52cbd03dc80a360fc">
            <figure class="image">
              <img style="aspect-ratio:651/364;" src="11_Vulnerability Assessment_i.png"
              width="651" height="364">
            </figure>
          </li>
          <li data-list-item-id="e23d8b0b81e0c67693945cde1b209517c">for common vulnerability scanning</li>
          <li data-list-item-id="ecb217a007388fec4d0c04ace01b66b50">automating the process of scanning</li>
          <li data-list-item-id="e14664b1fad5fc706231b4ace8cbbebe6">can be directly used from within metasploit</li>
          <li data-list-item-id="e861af40080517bd89150be90930abaf6"><strong>load wmap </strong>to load wmap module</li>
          <li data-list-item-id="e2a5b6d0fc633289ec3415ae10b4d5b3f">
            <figure class="image">
              <img style="aspect-ratio:543/323;" src="18_Vulnerability Assessment_i.png"
              width="543" height="323">
            </figure>
          </li>
          <li data-list-item-id="eae625fa61b8a3357f77c811b18fb8114"><strong>wmap_run</strong> -h to see the usage options</li>
          <li data-list-item-id="ec880064226ff6e23525924c29b9e7040"><strong>wmap_run -t</strong> to see all the loaded modules</li>
          <li data-list-item-id="e18c29b8f3556ae4cebd24c33f7d4795c"><strong>wmap_run -e</strong> to run the scan with all the loaded modules</li>
          <li
          data-list-item-id="e5f8d40a26c4b01449308744b97b914f5"><strong>wmap_vulns -l</strong> to list all the vulnerabilities found</li>
        </ul>
        <hr>
        <h3>CTF Insights</h3>
        <ul>
          <li data-list-item-id="ee2525fba70e51f77bdf14cad67bccc01">if a server is configured using php check <strong>http://url/phpingo.php </strong>to
            see if the devs forgot the info file
            <ul>
              <li data-list-item-id="e8d6e1de4d18058fc48a1509c79ab5392">A phpinfo() page is often left by developers for debugging, but it dumps
                everything about the server, including:</li>
              <li data-list-item-id="ef9df876f3bedbf645883d389b153fb53">PHP version and extensions (good for finding known exploits)</li>
              <li data-list-item-id="ea6b66e6493865cffe886ec0d8b57427b">Loaded configuration files (php.ini paths, Apache configs)</li>
              <li data-list-item-id="e0aca1e6cc3a4b43fdc8e1fcd64416ca9">Environment variables (may include database credentials, API keys)</li>
              <li
              data-list-item-id="e17ac88313089da69f0544efce7df8670">Document root paths (useful for path traversal / LFI)</li>
          <li data-list-item-id="e7224a9fc3ded01580297132bb50a6f75">Session storage locations (possible session hijacking)</li>
          <li data-list-item-id="e596145a542efb232e753dfb70a5cc175">Temporary directory paths (could be writable for uploads)</li>
          <li class="ck-list-marker-bold"
          data-list-item-id="e6ba2caff9aeead5c98294189f57fb2cf">
            <h2><strong>What to Do If You Find One</strong></h2>
          </li>
          <li data-list-item-id="e0f65dd9ba65c1365549d4f3db160fd56"><strong>View it in browser</strong> and scroll carefully â€” CTF flags are
            sometimes literally printed there in a comment or variable.</li>
          <li data-list-item-id="e98100889809ae1f789174932dfbae2aa">Search the output for:
            <ul>
              <li data-list-item-id="e21467990eec930e0cc1e8f60e58b6f7d"><code>DB_PASS</code>, <code>MYSQL</code>, <code>API_KEY</code>, <code>SECRET</code>
              </li>
              <li data-list-item-id="e11c0ab97beed1ee2f5911141b482bc04">Paths like <code>/var/www/html/...</code>
              </li>
            </ul>
          </li>
          <li data-list-item-id="eea0cef0951bd03c619ca468c45d0f468">Check for <strong>version-specific vulnerabilities</strong> for:
            <ul>
              <li data-list-item-id="e446fa64af6499017af7ba4998ba3840c">PHP version</li>
              <li data-list-item-id="e2ee392f62506036d6c716bdcd42b7c5b">Apache/Nginx version</li>
              <li data-list-item-id="e6a31a868101ccdcfd4080b3c0315db77">Installed extensions (like <code>gd</code>, <code>imagick</code>, <code>curl</code>)</li>
            </ul>
          </li>
          </ul>
          </li>
          <li data-list-item-id="e1442b60ab84e273ea5dd4ff6289c57bf">There can be version control files accessible on the server like <strong>.git etc</strong> GPT
            version control file in webserver to see all the list of the files&nbsp;</li>
        </ul>
      </div>
    </div>
  </body>

</html>